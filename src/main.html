

<!DOCTYPE HTML>
<html>
<head>

	<script type="text/javascript" src="./dependencies/codef/codef_core.js"></script> 

	<script type="text/javascript" src="./dependencies/codef/codef_stats.js"></script> 
	
	<script type="text/javascript" src="./data/music0.s3m.js"></script>
	<script type="text/javascript" src="./data/music1.s3m.js"></script>
	 

	<script type="text/javascript" src="./data/part01_ALKU_data.js"></script>
	<script type="text/javascript" src="./data/part02_U2A_data.js"></script>
	<script type="text/javascript" src="./data/part03_PAM_data.js"></script>
	<script type="text/javascript" src="./data/part04_BEGLOGO_data.js"></script>
	<script type="text/javascript" src="./data/part05_GLENZ_data.js"></script>
	<script type="text/javascript" src="./data/part06_GLENZ3D_data.js"></script>
	<script type="text/javascript" src="./data/part08_TECHNO_data_circle.js"></script> 
  	<script type="text/javascript" src="./data/part11_TECHNO_data_troll.js"></script> 
  	<script type="text/javascript" src="./data/part12_FOREST_data.js"></script> 
  	<script type="text/javascript" src="./data/part13_LENS_data.js"></script> 
  	<script type="text/javascript" src="./data/part19_WATER_data.js"></script> 
  	<script type="text/javascript" src="./data/part20_COMAN_data.js"></script> 
  	<script type="text/javascript" src="./data/part21_JPLOGO_data.js"></script> 
	<script type="text/javascript" src="./data/part22_U2E_data.js"></script>
  	<script type="text/javascript" src="./data/part23_ENDLOGO_data.js"></script>
  	<script type="text/javascript" src="./data/part24_CREDITS_data.js"></script>
  	<script type="text/javascript" src="./data/part25_ENDSCRL_data.js"></script>

	<script type="text/javascript" src="./dependencies/webaudio-mod-player/utils.js"></script>
	<script type="text/javascript" src="./dependencies/webaudio-mod-player/player.js"></script>
	<script type="text/javascript" src="./dependencies/webaudio-mod-player/st3.js"></script>
	
	<script type="text/javascript" src="./customised-webaudio-mod-player.js"></script>
	
	<script src="utils.js"></script> 
	<script src="graphics.js"></script> 
	<script src="MusicPlayer.js"></script> 
	
    <script src="u2_fillpoly.js"></script> 
	<script src="u2_drawclip.js"></script> 
	<script src="u2_calc.js"></script> 
	<script src="u2_main.js"></script> 

	<script src="part01_ALKU.js"></script>
	<script src="part02_U2A.js"></script> 
	<script src="part03_PAM.js"></script> 
	<script src="part04_BEGLOGO.js"></script>
	<script src="part05_GLENZ_TRANSITION.js"></script> 
	<script src="part06_GLENZ_3D.js"></script>
	<script src="part07_TUNNELI.js"></script> 
	<script src="part08_TECHNO_CIRCLES.js"></script> 
	<script src="part09_TECHNO_TRANSITION.js"></script> 
    <script src="part10_TECHNO_BARS.js"></script> 	
    <script src="part11_TECHNO_TROLL.js"></script> 	
	<script src="part12_FOREST.js"></script> 
	<script src="part13_LENS_TRANSITION.js"></script> 
	<script src="part14_LENS_LENS.js"></script> 		
	<script src="part15_LENS_ROTO.js"></script> 
	<script src="part16_PLZ_PLASMA.js"></script> 
	<script src="part17_PLZ_CUBE.js"></script>
	<script src="part18_DOTS.js"></script>
	<script src="part19_WATER.js"></script>
	<script src="part20_COMAN.js"></script>
	<script src="part21_JPLOGO.js"></script>
	<script src="part22_U2E.js"></script>
	<script src="part23_ENDLOGO.js"></script>
	<script src="part24_CREDITS.js"></script>
	<script src="part25_ENDSCRL.js"></script>


	<script src="main.js"></script> 


</head> 
<body bgcolor="#333">
<style type="text/css"> 
    :root {
        --bg-color: #222; 
    }

    body { 
        background-color: var(--bg-color);
        margin: 0; padding: 0; 
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        display: flex; flex-direction: column; align-items: center;
    }


    .fullscreen {
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: var(--bg-color); 
        width: 100%;
        min-height: 400px; 
        height: auto; 
        margin-top: 50px;
        position: relative;
        overflow: visible; 
    }

    #main canvas {
        height: 400px !important; 
        width: 640px !important;
        background-color: #000;
        image-rendering: pixelated;
        display: block; 
    }

    .forced43 #main canvas {
        width: 640px !important;
        height: 480px !important; /* 640 / (4/3) = 480 */
        aspect-ratio: 4 / 3 !important;
        object-fit: fill !important;
    }


    #fullscreen:fullscreen #main canvas,
    #fullscreen:-webkit-full-screen #main canvas {
        height: 100vh !important; 
        width: auto !important;
        aspect-ratio: 4 / 3; 
    }

    
    button {
        background: transparent; color: white; border: 1px solid rgba(255,255,255,0.3);
        padding: 12px 28px; font-size: 13px; text-transform: uppercase;
        letter-spacing: 2px; cursor: pointer; transition: all 0.3s ease; margin-top: 20px;
    }
    button:hover { background: white; color: black; }
    #startBtn { position: absolute; z-index: 10; }
    #fullscr { visibility: hidden; }
    .smoothing-on #main canvas { image-rendering: auto !important; }
    .controls-container { color: #888; margin-top: 10px; text-align: center; }
    label { cursor: pointer; font-size: 11px; margin: 0 15px; }
    /* Part selector styles */
    #partSelector {
        background: transparent;
        color: #888;
        border: 1px solid rgba(255,255,255,0.2);
        padding: 8px 15px;
        font-size: 11px;
        letter-spacing: 1px;
        text-transform: uppercase;
        outline: none;
        cursor: pointer;
        transition: all 0.3s;
        appearance: none; 
        -webkit-appearance: none;
        text-align: center;
    }

    #partSelector:hover {
        color: white;
        border-color: rgba(255,255,255,0.6);
    }

    #partSelector option {
        background: #222; 
        color: white;
    }    
</style>
<style>
    .note-container {
        max-width: 640px; 
        margin: 30px auto 0;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.05); 
        text-align: center;
    }

    .warning-note {
        color: #777; 
        font-size: 13px;
        line-height: 1.6;
        font-style: normal;
        margin: 5px 0;
    }

    .note-label {
        color: #888; 
        font-weight: bold;
        font-style: normal;
        text-transform: uppercase;
        font-size: 12px;
        margin-right: 8px;
        letter-spacing: 0.5px;
    }

    .source-link-bottom {
        margin-top: 30px;
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
    }

    .source-link-bottom a {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #888; 
        text-decoration: none;
        font-size: 11px;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        transition: all 0.3s ease;
        padding: 5px 10px;
        border: 1px solid transparent;
    }

    .source-link-bottom a:hover {
        color: #fff;
        border: 1px solid rgba(255,255,255,0.1);
        background: rgba(255,255,255,0.02);
    }

    .source-link-bottom svg {
        opacity: 0.5;
    }

    .source-link-bottom a:hover svg {
        opacity: 1;
    }
</style>

<script>
	function fullscr(elemId) {
		var elem = document.getElementById(elemId);
		if (elem.requestFullscreen) {
			elem.requestFullscreen();
		} else if (elem.mozRequestFullScreen) {
				elem.mozRequestFullScreen();
		} else if (elem.webkitRequestFullScreen) {
				elem.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);
		}
	}
</script>

<center>
    <div id="fullscreen" class="fullscreen">
        <button id="startBtn">Press button to enter Second Reality</button>
        <div id="main"></div>
    </div>

    <div class="controls-container">
        <button id="fullscr" onclick="fullscr('fullscreen');">View Fullscreen</button>

        <div class="checkbox-group">
            <label><input type="checkbox" id="aspectRatioToggle"> FORCE 4:3 ASPECT RATIO</label>
            <label><input type="checkbox" id="smoothingToggle"> ENABLE SMOOTHING</label>
        </div>
        <br>
        <div class="navigation-menu">
            <select id="partSelector" disabled>
                <option value="" disabled selected>Jump to part...</option>
                <option value="ALKU">01 - Intro</option>
                <option value="GLENZ">02 - Glenz Vectors</option>
                <option value="TUNNELI">03 - Tunnel </option>
                <option value="TECHNO">04 - Techno</option>
                <option value="FOREST">05 - Forest scroller</option>
                <option value="LENS">06 - Lens</option> 
                <option value="PLASMA">07 - Plasma</option> 
                <option value="WATER">08 - Water & Sword</option> 
                <option value="COMAN">09 - Voxel</option> 
                <option value="U2E">10 - City overfly</option> 
                <option value="CREDITS">11 - Credits</option> 
            </select>
         </div>
        <div class="note-container">
            <p class="warning-note">
                - 20 first seconds of the demo is just ambient sound over black background - 
            </p>
            <p class="warning-note" style="margin-top: 5px;">
                - Jumping to a part may lead to altered music (due to sequential nature of S3M files) -
            </p>
        </div>

        <div class="source-link">
            <div class="source-link-bottom">
                    <a href="https://github.com/covalichou/second-reality-js" target="_blank" rel="noopener">
                        <svg height="16" width="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path>
                        </svg>
                        <span>View Source Code on GitHub</span>
                    </a>
                </div>
        </div>
    </div>
</center>
<script>
    document.getElementById('startBtn').addEventListener('click', function() {
        // Button smooth removal animation
        this.style.opacity = '0';
        setTimeout(() => {
            this.style.display = 'none';
            document.getElementById('fullscr').style.visibility = 'visible';
            document.getElementById('fullscr').style.opacity = '1';
        }, 300);

        // Unlock Audio
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        if (AudioContext) {
            const context = new AudioContext();
            if (context.state === 'suspended') context.resume();
        }

        // Init Demo
        if (typeof window.init === 'function') window.init();

        // Enable part selector
        document.getElementById('partSelector').disabled = false;
    });

    const ratioToggle = document.getElementById('aspectRatioToggle');
    const smoothingToggle = document.getElementById('smoothingToggle');
    const container = document.getElementById('fullscreen');

    ratioToggle.addEventListener('change', function() {
        container.classList.toggle('forced43', this.checked);
    });

    smoothingToggle.addEventListener('change', function() {
        container.classList.toggle('smoothing-on', this.checked);
    });
    // Part selector logic
    document.getElementById('partSelector').addEventListener('change', function() {
    const partName = this.value;
    
    if (partName) {
        console.log("Jumping to part: " + partName);
        window.GoToPart(partName); 
    }
    setTimeout(() => {  this.selectedIndex = 0;  }, 100);  //enable to reselect same part
});
</script>
</body>
</html>
